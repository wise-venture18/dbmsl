13) Dept/teacher â€“ aggregates + index
############13.Perform aggregation and Indexing using mongodb on below database
1. Create a database department
2. Create a collection as teacher with fields as name , department ,experience and salary
3. Display the department wise average salary.
4. Display the no. Of employees working in each department.
5. Display the department wise minimum salary.
6. Apply index and drop index################

-----------------------------------------------------------------------------------------------

use department;
db.teacher.insertMany([
 {name:"t1",department:"CS",experience:3,salary:15000},
 {name:"t2",department:"CS",experience:5,salary:25000},
 {name:"t3",department:"IT",experience:4,salary:20000}
]);
db.teacher.aggregate([{$group:{_id:"$department", avgSal:{$avg:"$salary"}}}]);
db.teacher.aggregate([{$group:{_id:"$department", cnt:{$sum:1}}}]);
db.teacher.aggregate([{$group:{_id:"$department", minSal:{$min:"$salary"}}}]);
db.teacher.createIndex({department:1}); db.teacher.dropIndex({department:1});


----------------------------------------------------------------------------------------
ğŸ§± PS13 â€“ MongoDB (Department / Teacher â€“ Aggregates + Index)
ğŸ’¡ Aim:

Perform aggregate operations (average, count, min) and demonstrate index creation and deletion on a teacher collection.

âœ… Step-by-Step Code with Explanation
ğŸ§© Step 1 â€” Create / use database
use department;


ğŸ‘‰ Switches to or creates a database named department.

ğŸ§© Step 2 â€” Insert teacher data
db.teacher.insertMany([
  {name:"t1", department:"CS", experience:3, salary:15000},
  {name:"t2", department:"CS", experience:5, salary:25000},
  {name:"t3", department:"IT", experience:4, salary:20000}
]);

ğŸ” Explanation:

Creates a collection named teacher and inserts 3 documents.
Each document contains:
| Field | Meaning |
|:--|:--|
| name | Teacherâ€™s name |
| department | Department name (CS or IT) |
| experience | Years of experience |
| salary | Salary in rupees |

âœ… Resulting Data:

[
  {name:"t1", department:"CS", experience:3, salary:15000},
  {name:"t2", department:"CS", experience:5, salary:25000},
  {name:"t3", department:"IT", experience:4, salary:20000}
]

âš™ï¸ AGGREGATION

Aggregation means performing group-wise calculations (like SQLâ€™s GROUP BY) using MongoDBâ€™s aggregate() pipeline.

ğŸ§© 1ï¸âƒ£ Find average salary department-wise
db.teacher.aggregate([
  { $group: { _id: "$department", avgSal: { $avg: "$salary" } } }
]);

ğŸ” Explanation:

$group: groups documents by a specific field (department).

_id:"$department" â†’ group key (like GROUP BY department in SQL).

avgSal:{$avg:"$salary"} â†’ computes average salary per department.

âœ… Output:

[
  { "_id": "CS", "avgSal": 20000 },
  { "_id": "IT", "avgSal": 20000 }
]


âœ… Both CS and IT departments have an average salary of 20000.

ğŸ§© 2ï¸âƒ£ Count number of teachers in each department
db.teacher.aggregate([
  { $group: { _id: "$department", cnt: { $sum: 1 } } }
]);

ğŸ” Explanation:

$sum:1 â†’ increments count by 1 for each document.

Gives the total number of teachers in each department.

âœ… Output:

[
  { "_id": "CS", "cnt": 2 },
  { "_id": "IT", "cnt": 1 }
]

ğŸ§© 3ï¸âƒ£ Find minimum salary department-wise
db.teacher.aggregate([
  { $group: { _id: "$department", minSal: { $min: "$salary" } } }
]);

ğŸ” Explanation:

$min â†’ finds the smallest value in each group (here, minimum salary).

âœ… Output:

[
  { "_id": "CS", "minSal": 15000 },
  { "_id": "IT", "minSal": 20000 }
]

âš™ï¸ INDEXING

Indexes improve the speed of data retrieval operations on a collection.
They are like the index in a book â€” instead of scanning all pages, MongoDB jumps directly to the required record.

ğŸ§© 4ï¸âƒ£ Create an index on department
db.teacher.createIndex({ department: 1 });

ğŸ” Explanation:

createIndex({ department: 1 }) â†’ creates an ascending index on the department field.

This helps MongoDB find teachers by department faster during queries.

1 = ascending order, -1 = descending order.

âœ… Output:

{
  "createdCollectionAutomatically" : false,
  "numIndexesBefore" : 1,
  "numIndexesAfter" : 2,
  "ok" : 1
}


âœ… Index successfully created.

ğŸ§© 5ï¸âƒ£ Drop (remove) the index
db.teacher.dropIndex({ department: 1 });

ğŸ” Explanation:

Removes the previously created index.

Used when an index is no longer required or to free memory.

âœ… Output:

{ "nIndexesWas": 2, "ok": 1 }

ğŸ§  Detailed Concepts
ğŸ§© 1. Aggregation

Definition:
Aggregation is a process of combining multiple documents and performing operations like sum, average, count, min, max etc. on grouped data.

Analogy:
Like SQL query:

SELECT department, AVG(salary)
FROM teacher
GROUP BY department;


Main Operators:

Operator	Meaning
$group	Groups data by a specific field
$avg	Finds average
$sum	Adds values or counts records
$min	Finds minimum value
$max	Finds maximum value
ğŸ§© 2. Indexing

Definition:
An index is a special data structure that improves the speed of query operations in MongoDB.

Example analogy:
Without an index â€” searching a name in a full book (page by page).
With an index â€” directly jump to the page number from the index section.

Command:

db.collection.createIndex({ fieldname: 1 });


Types of indexes:

Type	Description
Ascending Index (1)	Sorts data in ascending order
Descending Index (-1)	Sorts data in descending order
Compound Index	Index on multiple fields
Unique Index	Ensures field values are unique

Benefits:

Fast searching and sorting

Efficient query execution

Better performance for large datasets

Drawbacks:

Takes extra storage

Slight overhead for insert/update operations

ğŸ§¾ Viva Questions & Answers
Question	                                                                                        Answer
What is Aggregation in MongoDB?	                                   Itâ€™s a process to group documents and perform calculations like sum, avg, min, max.
What is the purpose of $group?                                       	Groups documents by a specified key (like department).
What does $avg do?	                                              Calculates the average value of a numeric field.
What does $sum:1 mean?                                             	Counts the number of documents in each group.
What is Indexing in MongoDB?	                                         It is a structure that speeds up searching and sorting in collections.
Syntax to create index?	                                                 db.collection.createIndex({ field: 1 })
Why do we drop index?	                                                 To remove unnecessary indexes and free memory.
